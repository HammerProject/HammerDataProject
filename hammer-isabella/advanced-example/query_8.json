//
// Hammer Project
// @ 2016 Hammer Project
// www.hammer-project.com
// mauro.pelucchi@gmail.com
//
// 
// Restaurant Violations in Washington
// 
// from http://opendatadc.org
// (OpenDataDC is a public data catalog for and by the people of Washington, DC)
//
// SQL
// SELECT date, violation
// FROM inspections
// WHERE city = "Washington" and type = "restaurant"

{
  "select": [
  	  { "column": { "instance": "inspections", "label":"date"}},
      { "column": { "instance": "inspections", "label":"violation"}}
  ],
  "from": [
    "inspections"
  ],
  "where": [{"condition": {
      "instance1": "inspections",
      "label1": "type",
      "operator": "eq",
      "value": "restaurant",
      "logicalOperator": "and"
    }},{"condition": {
      "instance1": "inspections",
      "label1": "city",
      "operator": "eq",
      "value": "Washington",
      "logicalOperator": "and"
    }}
  ]
}

//
// Open Data Sources (total) --> 27 (number of record in opendatasource collection)
// Open Data Resources (total) --> 39716 (number of record in opendataresource collection)
// Index keywords (total) --> 77027 (number of keywords in inverted index)
// (updated 4/5/2016 06:59)
//
// Selected keywords
// ----> washington
// ----> restaurant
// ----> inspections

// 
// db.index.aggregate([
// 	{ $match: {"$or" : [ { "keyword" : "washington"} , { "keyword" : "restaurant"}, { "keyword" : "inspections"}]} },
// 	{ $project: {total: { $size: "$documents" }}}
//  ]);
//
// { "_id" : "restaurant", "total" : 1 }
// { "_id" : "washington", "total" : 6 }
// { "_id" : "inspections", "total" : 9 }
//
// Resources (distinct) --> 16
//
// Without keywords
//  db.index.aggregate([
//  	{ $match: {"$or" : [ { "keyword" : "type"} ,  { "keyword" : "city"} , { "keyword" : "violation"} , { "keyword" : "date"} ,  { "keyword" : "washington"} , { "keyword" : "restaurant"}, { "keyword" : "inspections"}]} },
//  	{ $project: {total: { $size: "$documents" }}}
//   ]);
//
//
// { "_id" : "date", "total" : 63 }
// { "_id" : "inspections", "total" : 9 }
// { "_id" : "city", "total" : 240 }
// { "_id" : "restaurant", "total" : 1 }
// { "_id" : "type", "total" : 380 }
// { "_id" : "washington", "total" : 6 }

// Documents --> 399