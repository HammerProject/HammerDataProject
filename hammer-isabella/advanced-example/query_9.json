//
// Hammer Project
// @ 2016 Hammer Project
// www.hammer-project.com
// mauro.pelucchi@gmail.com
//
// 
// Location, coordinates and number of available bikes (excluding locked or faulty bikes)
// in London
//
// http://data.london.gov.uk
// 
//
// SQL
// SELECT day, number
// FROM cycle
// WHERE city = "London" and day >= '01/01/2016' and day <= '31/01/2016'

{
  "select": [
  	  { "column": { "instance": "cycle", "label":"day"}},
      { "column": { "instance": "cycle", "label":"hire"}}
  ],
  "from": [
    "cycle"
  ],
  "where": [{"condition": {
      "instance1": "cycle",
      "label1": "city",
      "operator": "eq",
      "value": "London",
      "logicalOperator": "and"
    }},{"condition": {
      "instance1": "cycle",
      "label1": "day",
      "operator": "ge",
      "value": "01/01/2016",
      "logicalOperator": "and"
    }},{"condition": {
      "instance1": "cycle",
      "label1": "day",
      "operator": "le",
      "value": "31/01/2016",
      "logicalOperator": "and"
    }}
  ]
}

//
// Open Data Sources (total) --> 27 (number of record in opendatasource collection)
// Open Data Resources (total) --> 39716 (number of record in opendataresource collection)
// Index keywords (total) --> 77027 (number of keywords in inverted index)
// (updated 4/5/2016 06:59)
//
// Selected keywords
// ----> 31/01/2016
// ----> 01/01/2016
// ----> London
// ----> cycle

// 
//  db.index.aggregate([
//  	{ $match: {"$or" : [ { "keyword" : "london"} , { "keyword" : "cycle"} , { "keyword" : "31/01/2016"}, { "keyword" : "01/01/2016"}]} },
//  	{ $project: {total: { $size: "$documents" }}}
//   ]);
// 

// { "_id" : "london", "total" : 1368 }
// { "_id" : "cycle", "total" : 37 }
// { "_id" : "31/01/2016", "total" : 2 }
//
// Resources (distinct) --> 379
//
// Without keywords
//  db.index.aggregate([
//  	{ $match: {"$or" : [ { "keyword" : "city"} , { "keyword" : "number"} , { "keyword" : "day"} , { "keyword" : "london"} , { "keyword" : "cycle"} , { "keyword" : "01/01/2016"} , { "keyword" : "31/01/2016"}, { "keyword" : "01/01/2016"}]} },
//  	{ $project: {total: { $size: "$documents" }}}
//   ]);
//
// 
// { "_id" : "london", "total" : 1368 }
// { "_id" : "cycle", "total" : 37 }
// { "_id" : "day", "total" : 173 }
// { "_id" : "number", "total" : 745 }
// { "_id" : "31/01/2016", "total" : 2 }
// { "_id" : "city", "total" : 240 }
//
//
// Resources (distinct) --> 591