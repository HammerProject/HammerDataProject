//
// Hammer Project
// @ 2016 Hammer Project
// www.hammer-project.com
// mauro.pelucchi@gmail.com
//
// 
// Location, coordinates and number of available bikes (excluding locked or faulty bikes)
// in London
//
// http://data.london.gov.uk
// 
//
// SQL
// SELECT location, coordinates, available
// FROM cycle, hire
// WHERE city = "London" and locked = 0 and faulty = 0

{
  "select": [
  	  { "column": { "instance": "hire", "label":"location"}},
      { "column": { "instance": "hire", "label":"coordinates"}},
      { "column": { "instance": "cycle", "label":"available"}}
  ],
  "from": [
    "cycle",
    "hire"
  ],
  "where": [{"condition": {
      "instance1": "hire",
      "label1": "city",
      "operator": "eq",
      "value": "London",
      "logicalOperator": "and"
    }},{"condition": {
      "instance1": "cycle",
      "label1": "locked",
      "operator": "eq",
      "value": 0,
      "logicalOperator": "and"
    }},{"condition": {
      "instance1": "cycle",
      "label1": "faulty",
      "operator": "eq",
      "value": 0,
      "logicalOperator": "and"
    }}
  ]
}

//
// Datasource (total) --> 27
// Dataset (total) --> 39716
// Index keywords (total) --> 77027
// (updated 4/5/2016 06:59)
//
// Selected keywords
// ----> London
// ----> cycle
// ----> hire

// 
// db.index.aggregate([
// 	{ $match: {"$or" : [ { "keyword" : "london"} , { "keyword" : "cycle"} , { "keyword" : "hire"}]} },
// 	{ $project: {total: { $size: "$documents" }}}
//  ]);
// 
// { "_id" : "london", "total" : 1368 }
// { "_id" : "cycle", "total" : 37 }
// { "_id" : "hire", "total" : 14 }
// Documents --> 1419
//
// Without keywords
// db.index.aggregate([
// 	{ $match: {"$or" : [ { "keyword" : "available"} , { "keyword" : "coordinates"} , { "keyword" : "location"} , { "keyword" : "city"} , { "keyword" : "locked"} , { "keyword" : "faulty"} , { "keyword" : "london"} , { "keyword" : "cycle"} , { "keyword" : "hire"}]} },
// 	{ $project: {total: { $size: "$documents" }}}
//  ]);
//
// 
// { "_id" : "locked", "total" : 2 }
// { "_id" : "london", "total" : 1368 }
// { "_id" : "location", "total" : 187 }
// { "_id" : "coordinates", "total" : 262 }
// { "_id" : "cycle", "total" : 37 }
// { "_id" : "faulty", "total" : 2 }
// { "_id" : "hire", "total" : 14 }
// { "_id" : "available", "total" : 642 }
// { "_id" : "city", "total" : 240 }

// Documents --> 2754