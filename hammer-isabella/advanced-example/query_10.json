//
// Hammer Project
// @ 2016 Hammer Project
// www.hammer-project.com
// mauro.pelucchi@gmail.com
//
// 
// Number of International Visitors (total visits and total spend) to London for Holiday from Italy
// 
//
// http://data.london.gov.uk
// 
//
// SQL
// SELECT market, visits, spent, purpose
// FROM tourists
// WHERE city = "London" and year = 2015 and purpose = "Holiday" and market = "Italy"

{
  "select": [
  	  { "column": { "instance": "tourists", "label":"market"}},
      { "column": { "instance": "tourists", "label":"visits"}},
      { "column": { "instance": "tourists", "label":"spent"}}
  ],
  "from": [
    "tourists"
  ],
  "where": [{"condition": {
      "instance1": "tourists",
      "label1": "city",
      "operator": "eq",
      "value": "London",
      "logicalOperator": "and"
    }},{"condition": {
      "instance1": "tourists",
      "label1": "year",
      "operator": "eq",
      "value": 2015,
      "logicalOperator": "and"
    }},{"condition": {
      "instance1": "tourists",
      "label1": "purpose",
      "operator": "eq",
      "value": "Holiday",
      "logicalOperator": "and"
    }},{"condition": {
      "instance1": "tourists",
      "label1": "market",
      "operator": "eq",
      "value": "Italy",
      "logicalOperator": "and"
    }}
  ]
}

//
// Open Data Sources (total) --> 27
// Open Data Resource (total) --> 39716
// Index keywords (total) --> 77027
// (updated 4/5/2016 06:59)
//
// Selected keywords
// ----> Italy
// ----> Holiday
// ----> London
// ----> tourists

// 
//  db.index.aggregate([
//  	{ $match: {"$or" : [  { "keyword" : "italy"} , { "keyword" : "london"} , { "keyword" : "holiday"} , { "keyword" : "tourists"}]} },
//  	{ $project: {total: { $size: "$documents" }}}
//   ]);
// 

// { "_id" : "london", "total" : 1368 }
// { "_id" : "italy", "total" : 1 }
// { "_id" : "holiday", "total" : 1 }
// { "_id" : "tourists", "total" : 5 }


/// Resources (distinct) --> 376
//
// Without keywords
//  db.index.aggregate([
//  	{ $match: {"$or" : [  { "keyword" : "year"} , { "keyword" : "2015"} , { "keyword" : "market"} , { "keyword" : "visits"} ,  { "keyword" : "spent"} ,  { "keyword" : "purpose"} , { "keyword" : "italy"} , { "keyword" : "london"} , { "keyword" : "holiday"} , { "keyword" : "tourists"}]} },
//  	{ $project: {total: { $size: "$documents" }}}
//   ]);
// 
//
// 
//{ "_id" : "london", "total" : 1368 }
//{ "_id" : "italy", "total" : 1 }
//{ "_id" : "market", "total" : 112 }
//{ "_id" : "holiday", "total" : 1 }
//{ "_id" : "2015", "total" : 803 }
//{ "_id" : "purpose", "total" : 90 }
//{ "_id" : "spent", "total" : 4 }
//{ "_id" : "tourists", "total" : 5 }
//{ "_id" : "visits", "total" : 8 }
//{ "_id" : "year", "total" : 630 }

// Resources (distinct) --> 1521